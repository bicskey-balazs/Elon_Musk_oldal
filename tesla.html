<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <title>Tesla</title>
</head>
<body>
    <div class="navbar">
        <div class="topnav">
            <a href="index.html">ELON</a>
            <a href="spacex.html">SpaceX</a>
            <a href="tesla.html" aria-label="active">Tesla</a>
            <a href="Neuralink.html">Neuralink</a>
        </div>
    </div>

    <ul class="quickNav">
        <li aria-label="selected">
            <a href="#S" class="noselect">
                Model S
            </a>
        </li>
        <li>
            <a href="#3" class="noselect">
                Model 3
            </a>
        </li>
        <li>
            <a href="#X" class="noselect">
                Model X
            </a>
        </li>
        <li>
            <a href="#Y" class="noselect">
                Model Y
            </a>
        </li>
    </ul> 

    <div class="cnt">
        <div id="S" class="car">
            <h1>Tesla Model S</h1>
            <div class="view360">
                <img src="képek/ModelS/letöltés (0).png" alt="">
                <div class="slider">
                    <div class="handle" style="left: 0"></div>
                </div>
            </div>
        </div>
        <div id="3" class="car">
            <h1>Tesla Model 3</h1>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Illum vitae cum quisquam ullam minus nam obcaecati eius magni error quas officia, iste necessitatibus dignissimos nobis tenetur totam natus quasi ipsum.</p>
        </div>
        <div id="X" class="car">
            <h1>Tesla Model X</h1>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Dignissimos fugit voluptatum odit autem obcaecati beatae dicta optio expedita, laudantium aliquid minus alias est consequatur fuga vero similique totam. Sunt, commodi!</p>
        </div>
        <div id="Y" class="car">
            <h1>Tesla Model Y</h1>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Dignissimos fugit voluptatum odit autem obcaecati beatae dicta optio expedita, laudantium aliquid minus alias est consequatur fuga vero similique totam. Sunt, commodi!</p>
        </div>
    </div>
</body>
</html>

<style>
    .slider .handle {
        background-color: rgb(120, 120, 120); 
        width: 20px; 
        height: 20px; 
        position: absolute; 
        bottom: 50%; 
        translate: 0 50%;
        border-radius: 50%;
        transition: .1s all linear;
    }
    .slider .handle:hover,
    .slider .handle:active,
    .slider .handle:focus {
        background-color: rgb(160, 160, 160);
        transform: scale(120%);
    }

    .slider{
        background-color: rgba(70, 70, 70, 0.3); 
        width: 500px; 
        height: 5px; 
        margin: 0 auto; 
        position: relative; 
        margin-top: 20px;
        border-radius: 50px;
    }
    
    html{
        scroll-behavior: smooth;
    }
    
    .quickNav{
        position: fixed;
        top:50%;
        left:0;
        transform: translate("-50% -50%");
        list-style-type: disc;
        padding-left: 30px;
    }

    .quickNav li{
        color: rgb(111, 111, 111);
        font-size: 1em;
        transition: all .2s linear;
        margin-bottom: 4px;
    }

    .quickNav li[aria-label="selected"]{
        color: rgb(244, 244, 244);
        font-size: 1.2em;
    }

    .quickNav li:hover{
        color: rgb(244, 244, 244);
        padding-left: 5px;
    }

    .quickNav a{
        color: inherit;
        text-decoration: none;
    }

    .car{
        height: 100vh;
        text-align: center;
        padding-top: 50px;
    }
    
    .car h1{
        margin-bottom: 50px;
    }
    
    .view360 img{
        height: 500px;
        clip-path: inset(50px 10px 50px 10px round 20px);
    }
    
</style>

<script defer>
    const clamp = (num, min, max) => Math.min(Math.max(num, min), max);

    function quickNav(){
        const contentChild = document.querySelectorAll(".cnt div");
        const navElements = document.querySelectorAll(".quickNav li");

        addEventListener("scroll", (e)=>{
            for(let i = 0; i < contentChild.length; i++){
                var height = contentChild[i].offsetHeight;
                var scroll = window.scrollY;

                var current = Math.floor(scroll/height);

                for(let j = 0; j < navElements.length; j++){  
                    if (j == current) navElements[j].setAttribute("aria-label", "selected");
                    else navElements[j].removeAttribute("aria-label");
                }
            }
        });
    }

    function Rotate360(){
        const handles = document.querySelectorAll(".handle");

        var target = null;

        handles.forEach(handle => {
            handle.addEventListener("mousedown", (e)=>{
                target = e.target;
            }); 
        });

        window.addEventListener("mousemove", (e) => {
            if(target == null){ return; }

            RotateTesla(e.clientX, target);
        });

        window.addEventListener("mouseup", ()=>{
            target = null;  
        });
    }


    function RotateTesla(cursorX, handle, model){
        var midHandle = handle.offsetWidth/2;
        var newPos = (cursorX - handle.parentElement.offsetLeft - midHandle);
        var picNum = 50;
        
        newPos = clamp(newPos, 0, handle.parentElement.offsetWidth - midHandle);
        
        var divider = handle.parentElement.offsetWidth / picNum;
        var snappedPos = Math.round(newPos / divider) * divider;
        
        var currentPic = snappedPos / divider;
        
        handle.style.left = snappedPos + "px";
        handle.parentElement.previousElementSibling.src = "képek/ModelS/letöltés (" + currentPic + ").png";
    }

    quickNav();
    Rotate360();

</script>
